<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SUDOKU SOLVER</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0a;
    --surface: #111111;
    --border: #2a2a2a;
    --accent: #00ff88;
    --accent2: #ff3355;
    --text: #e0e0e0;
    --dim: #444;
    --given: #00ff88;
    --solved: #5599ff;
    --cell: #161616;
    --cell-hover: #1e1e1e;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Press Start 2P', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem 1rem;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,255,136,0.015) 2px,
      rgba(0,255,136,0.015) 4px
    );
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2rem;
    width: 100%;
    max-width: 600px;
  }

  h1 {
    font-size: clamp(0.7rem, 3vw, 1.1rem);
    letter-spacing: 0.3em;
    color: var(--accent);
    text-shadow: 0 0 20px rgba(0,255,136,0.4), 0 0 40px rgba(0,255,136,0.1);
    text-align: center;
    animation: flicker 8s infinite;
  }

  @keyframes flicker {
    0%, 95%, 100% { opacity: 1; }
    96% { opacity: 0.6; }
    97% { opacity: 1; }
    98% { opacity: 0.4; }
    99% { opacity: 1; }
  }

  .subtitle {
    font-size: 0.35rem;
    color: var(--dim);
    letter-spacing: 0.4em;
    margin-top: -1.5rem;
  }

  /* GRID */
  .grid-wrapper {
    position: relative;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(9, 1fr);
    border: 2px solid var(--accent);
    box-shadow: 0 0 30px rgba(0,255,136,0.15), inset 0 0 30px rgba(0,0,0,0.5);
    gap: 0;
  }

  .cell {
    width: clamp(36px, 9vw, 54px);
    height: clamp(36px, 9vw, 54px);
    background: var(--cell);
    border: 1px solid var(--border);
    text-align: center;
    font-family: 'Press Start 2P', monospace;
    font-size: clamp(0.55rem, 2vw, 0.75rem);
    color: var(--solved);
    caret-color: var(--accent);
    outline: none;
    transition: background 0.1s, color 0.1s;
  }

  .cell:focus {
    background: var(--cell-hover);
    box-shadow: inset 0 0 8px rgba(0,255,136,0.2);
    color: var(--text);
  }

  .cell.given {
    color: var(--given);
    background: #0d1a12;
  }

  .cell.error {
    background: #1a0a0a;
    color: var(--accent2);
    animation: shake 0.3s ease;
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-2px); }
    75% { transform: translateX(2px); }
  }

  /* Thick borders for 3x3 boxes */
  .cell[data-col="3"],
  .cell[data-col="6"] { border-left: 2px solid var(--accent); }
  .cell[data-row="3"],
  .cell[data-row="6"] { border-top: 2px solid var(--accent); }

  /* CONTROLS */
  .controls {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
  }

  .btn {
    font-family: 'Press Start 2P', monospace;
    font-size: 0.5rem;
    padding: 0.8rem 1.2rem;
    border: 1px solid var(--accent);
    background: transparent;
    color: var(--accent);
    cursor: pointer;
    letter-spacing: 0.1em;
    transition: all 0.15s;
    position: relative;
    overflow: hidden;
  }

  .btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--accent);
    transform: translateY(100%);
    transition: transform 0.15s;
    z-index: -1;
  }

  .btn:hover::before { transform: translateY(0); }
  .btn:hover { color: var(--bg); }
  .btn:active { transform: scale(0.97); }

  .btn.danger {
    border-color: var(--accent2);
    color: var(--accent2);
  }
  .btn.danger::before { background: var(--accent2); }
  .btn.danger:hover { color: var(--bg); }

  /* STATUS */
  .status {
    font-size: 0.4rem;
    letter-spacing: 0.2em;
    min-height: 1.2em;
    transition: color 0.3s;
  }

  .status.success { color: var(--accent); text-shadow: 0 0 10px rgba(0,255,136,0.5); }
  .status.fail { color: var(--accent2); }
  .status.thinking { color: var(--dim); animation: blink 0.8s infinite; }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
  }

  /* Solving animation overlay */
  .solving-overlay {
    display: none;
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.5);
    align-items: center;
    justify-content: center;
  }
  .solving-overlay.active { display: flex; }
</style>
</head>
<body>

<div class="container">
  <h1>SUDOKU SOLVER</h1>
  <p class="subtitle">// BACKTRACKING ENGINE //</p>

  <div class="grid-wrapper">
    <div class="grid" id="grid"></div>
  </div>

  <div class="controls">
    <button class="btn" onclick="solve()">â–¶ SOLVE</button>
    <button class="btn" onclick="loadExample()">EXAMPLE</button>
    <button class="btn danger" onclick="clearGrid()">CLEAR</button>
  </div>

  <div class="status" id="status"></div>
</div>

<script>
  // Build grid
  const grid = document.getElementById('grid');
  for (let r = 0; r < 9; r++) {
    for (let c = 0; c < 9; c++) {
      const inp = document.createElement('input');
      inp.type = 'text';
      inp.maxLength = 1;
      inp.className = 'cell';
      inp.dataset.row = r;
      inp.dataset.col = c;
      inp.id = `c${r}${c}`;
      inp.addEventListener('input', e => {
        const v = e.target.value.replace(/[^1-9]/g, '');
        e.target.value = v;
        e.target.classList.remove('error');
      });
      inp.addEventListener('keydown', e => {
        const moves = { ArrowRight:[0,1], ArrowLeft:[0,-1], ArrowDown:[1,0], ArrowUp:[-1,0] };
        if (moves[e.key]) {
          e.preventDefault();
          const [dr, dc] = moves[e.key];
          const nr = Math.max(0, Math.min(8, +inp.dataset.row + dr));
          const nc = Math.max(0, Math.min(8, +inp.dataset.col + dc));
          document.getElementById(`c${nr}${nc}`).focus();
        }
      });
      grid.appendChild(inp);
    }
  }

  function getMatrix() {
    const mat = [];
    for (let r = 0; r < 9; r++) {
      mat.push([]);
      for (let c = 0; c < 9; c++) {
        const v = document.getElementById(`c${r}${c}`).value;
        mat[r].push(v ? parseInt(v) : 0);
      }
    }
    return mat;
  }

  function setMatrix(mat, givenMat) {
    for (let r = 0; r < 9; r++) {
      for (let c = 0; c < 9; c++) {
        const cell = document.getElementById(`c${r}${c}`);
        cell.value = mat[r][c] !== 0 ? mat[r][c] : '';
        cell.classList.remove('given', 'error');
        if (givenMat && givenMat[r][c] !== 0) cell.classList.add('given');
        else if (mat[r][c] !== 0) cell.classList.remove('given');
      }
    }
  }

  // Python solver ported to JS
  function isSafe(mat, row, col, num) {
    for (let x = 0; x < 9; x++) if (mat[row][x] === num) return false;
    for (let x = 0; x < 9; x++) if (mat[x][col] === num) return false;
    const sr = row - (row % 3), sc = col - (col % 3);
    for (let i = 0; i < 3; i++)
      for (let j = 0; j < 3; j++)
        if (mat[i + sr][j + sc] === num) return false;
    return true;
  }

  function sudoku(mat, row, col) {
    if (row === 8 && col === 9) return true;
    if (col === 9) { row++; col = 0; }
    if (mat[row][col] !== 0) return sudoku(mat, row, col + 1);
    for (let num = 1; num <= 9; num++) {
      if (isSafe(mat, row, col, num)) {
        mat[row][col] = num;
        if (sudoku(mat, row, col + 1)) return true;
        mat[row][col] = 0;
      }
    }
    return false;
  }

  function setStatus(msg, cls) {
    const s = document.getElementById('status');
    s.textContent = msg;
    s.className = 'status ' + (cls || '');
  }

  function solve() {
    const given = getMatrix();
    const mat = given.map(r => [...r]);

    // Validate: no duplicate given numbers
    for (let r = 0; r < 9; r++) {
      for (let c = 0; c < 9; c++) {
        const v = given[r][c];
        if (v !== 0) {
          given[r][c] = 0;
          if (!isSafe(given, r, c, v)) {
            given[r][c] = v;
            document.getElementById(`c${r}${c}`).classList.add('error');
            setStatus('INVALID PUZZLE', 'fail');
            return;
          }
          given[r][c] = v;
        }
      }
    }

    setStatus('SOLVING...', 'thinking');

    setTimeout(() => {
      const success = sudoku(mat, 0, 0);
      if (success) {
        setMatrix(mat, given);
        setStatus('SOLVED!', 'success');
      } else {
        setStatus('NO SOLUTION EXISTS', 'fail');
      }
    }, 50);
  }

  function clearGrid() {
    for (let r = 0; r < 9; r++)
      for (let c = 0; c < 9; c++) {
        const cell = document.getElementById(`c${r}${c}`);
        cell.value = '';
        cell.className = 'cell';
      }
    setStatus('');
  }

  function loadExample() {
    const example = [
      [5,3,0, 0,7,0, 0,0,0],
      [6,0,0, 1,9,5, 0,0,0],
      [0,9,8, 0,0,0, 0,6,0],

      [8,0,0, 0,6,0, 0,0,3],
      [4,0,0, 8,0,3, 0,0,1],
      [7,0,0, 0,2,0, 0,0,6],

      [0,6,0, 0,0,0, 2,8,0],
      [0,0,0, 4,1,9, 0,0,5],
      [0,0,0, 0,8,0, 0,7,9],
    ];
    clearGrid();
    setMatrix(example, example);
    setStatus('');
  }
</script>
</body>
</html>